<% provide(:title, @article.title) %>
       <h2>
         <%= @article.title %>
      </h2>
      <div class = "center">
      <%= link_to "Open article in new tab", @article.download_link, target: :_blank, class: 'btn btn-link mb-4' %>
    </div>

<% if logged_in? %>

<% if @query == "public" %>

<div class = "row">

<div class="col-md-8 my-2">

      <% @public_notes.each do |note| %>
      <%= render partial: "card", locals: {note: note, article_id: @article.id, query: "public"} %>
      <% end %>

    </div>

<div class="col-md-3">

  <%= link_to "View private notes", article_path(:id => @article.id), class: 'btn btn-primary my-2' %>

</div>

</div>


<% else %>

    <%= form_with scope: :note, url: notes_path(article_id: @article.id) do |form| %>

    <div class="row h-50">


      <div class="form-group col-md-8">
<!--     dividing form up into divs causes problems, need to refresh to submit again
 -->


        <%= form.hidden_field :is_public, :value => false %>
        <%= form.label :note_text, 'Take a note (Markdown and LaTeX [use $$ to start and end] supported):' %><br>
        <%= form.text_area :note_text, size: "30x15", class: "form-control", id: "textInput" %>

      </div>

      <div class="form-group col-md-3 ml-2">
          <label>Type </label><br/>

          <%= form.radio_button :note_type, 'note', :checked => true  %>
          <%= form.label :note_type, 'Note', :style => "display:inline" , class: 'badge badge-secondary' %>
          <br/>
          
          <%= form.radio_button :note_type, 'question' %>
          <%= form.label :note_type, 'Question', :style => "display:inline", class: 'badge badge-primary' %>

          <br/>

          <%= form.radio_button :note_type, 'summary' %>
          <%= form.label :note_type, 'Summary', :style => "display:inline", class: 'badge badge-success' %>

          <br/>

          <%= form.radio_button :note_type, 'code' %>
          <%= form.label :note_type, 'Code', :style => "display:inline", class: 'badge badge-warning' %>

          <br/>
          <br/>

          <label>PDF page number </label><br/>
          <%= form.number_field :page_num, :style => "display:inline", class: "form-control" %>

          <p>
            <%= form.submit class: "mb-2 btn btn-primary"%>
          </p>


      <% end %>


  </div>

</div>


<div class = "row">

  <div class = "col-md-8">

      <% @notes.each do |note| %>
      <%= render partial: "card", locals: {note: note, article_id: @article.id, query: "private"} %>
      <% end %>

  </div>

  <div class = "col-md-3">
    <%= link_to "View public notes", article_path(:id => @article.id, :query => "public"), class: 'btn btn-primary' %>


  </div>

</div>

    <% end %>


<% else %>
  

  <div class = "row">

    <div class = "col-md-8">

      <% @public_notes.each do |note| %>
      <%= render partial: "card", locals: {note: note, article_id: @article.id, query: "public"} %>
      <% end %>

  </div>

  <div class = "col-md-3">

    <%= link_to "Log in now to add notes", login_path, class: 'btn btn-primary' %>


  </div>

</div>

<% end %>

<script type="text/javascript">
if (window.MathJax) {
  MathJax.Hub.Queue(
    ["Typeset",MathJax.Hub]
  );
}
</script>


